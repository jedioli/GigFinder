<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GigFinder</title>

    <!-- Bootstrap -->
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	 
	<script type="text/javascript">
	//<!--
	  function findGig() {
			var genre = document.getElementById("inputGenre1").value;
			var country = document.getElementById("inputCountry1").value;
			alert("Here is a " + genre + " gig in " + country + "!");
	  }
	//-->
	</script>
	
	<!-- Google Maps API junk -->
	<!-- references:
	  https://developers.google.com/maps/documentation/javascript/examples/layer-heatmap
	  https://developers.google.com/maps/documentation/javascript/heatmaplayer
    -->
	<style type="text/css">
      html, body,
      #map-module {
        padding: 10px;
      } 
      #map-canvas { 
        height: 100%; 
        width: 100%; 
        float: left;
        margin: auto auto;
        padding: 200px;	
      }
      #side_panel {
        margin-left: -20px;
        margin-top: -250px;
        z-index: 5;
        float: right;	
        padding: 10px;
      }
      #find_gig {
        margin: 15px auto;
        padding: 10px;
      }
    </style>
	
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	
	<script type="text/javascript"
	  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBYXSqhgc3UWswbqksgbrH_gCiuyN1aCkM&libraries=visualization&sensor=true_or_false"> 
	</script>
    
	<script type="text/javascript">
	  var map, rockmap, heatmapData;
	  var testRockMapData = [];
	  var jazzmap;
	  var testJazzMapData = [];
	  var classmap;
	  var testClassMapData = [];
	  var countrymap;
	  var testCountryMapData = [];
	  var elecmap;
	  var testElecMapData = [];
	  
	  function mapDataParse(fileData, mapArray) {	//from here: http://stackoverflow.com/questions/7431268/how-to-read-data-from-csv-file-using-javascript/12289296#12289296
        var fileLines = fileData.split(/\r\n|\n/);
        //console.log('all split at lines');
        //console.log(fileLines[1]);
        for(var line = 1; line < (fileLines.length) / 10; ++line) {
          var coords = fileLines[line].split('\t');
          if (coords.length > 1) {
            mapArray.push(new google.maps.LatLng(coords[1], coords[2]));
          }
        }
        //console.log('length of mapArray: ' + mapArray.length);
	  }
	  
	  function loadTest() {
	    $.ajax({
	      type: 'GET',
	      url: 'mapData/spotifyMapData.txt',
	      //url: 'mapData/electronicaMapData.txt',
	      dataType: 'text',
	      success: function(data) {mapDataParse(data, testRockMapData);}
	    });
	  }
	  function loadTrial() {
	    $.ajax({
	      type: 'GET',
	      url: 'mapData/allMapData.txt',
	      dataType: 'text',
	      success: function(data) {mapDataParse(data, testElecMapData);}
	    });
	  }
	  function loadStudy() {
	    $.ajax({
	      type: 'GET',
	      url: 'mapData/under\ 2000MapData.txt',
	      dataType: 'text',
	      success: function(data) {mapDataParse(data, testCountryMapData);}
	    });
	  }
	  function loadVenture() {
	    $.ajax({
	      type: 'GET',
	      url: 'mapData/seen\ liveMapData.txt',
	      dataType: 'text',
	      success: function(data) {mapDataParse(data, testClassMapData);}
	    });
	  }
	  function loadAttempt() {
	    $.ajax({
	      type: 'GET',
	      //url: 'mapData/spotifyMapData.txt',
	      //url: 'mapData/electronicaMapData.txt',
	      url: 'mapData/noiseMapData.txt',
	      dataType: 'text',
	      success: function(data) {mapDataParse(data, testJazzMapData);}
	    });
	  }
	  
	  function initialize() {	
	  
	    loadTest();	//POSSIBLY USE getBounds TO ONLY GET POINTS WITHIN MAP RANGE??
	    loadTrial();
	    loadStudy();
	    loadVenture();
	    loadAttempt();
	    
	    /*
	    heatmapData = [
	      new google.maps.LatLng(30.617619, -96.346636),
	      new google.maps.LatLng(30.61762, -96.346637),
	      new google.maps.LatLng(30.617615, -96.346639),
	      new google.maps.LatLng(30.617949, -96.346292),
	      new google.maps.LatLng(30.617949, -96.346292),
	      new google.maps.LatLng(30.617949, -96.346292),
	      new google.maps.LatLng(30.618118, -96.346054),
	      new google.maps.LatLng(30.618852, -96.345765),
	      new google.maps.LatLng(30.618852, -96.345766),
	      new google.maps.LatLng(30.617172, -96.347162),
	      new google.maps.LatLng(30.617175, -96.347163),
	      new google.maps.LatLng(30.617173, -96.347161),
	      new google.maps.LatLng(30.617178, -96.347160),
	      new google.maps.LatLng(30.612271, -96.341497),
	      new google.maps.LatLng(30.612272, -96.341496),
	      new google.maps.LatLng(30.612275, -96.341501),
	      new google.maps.LatLng(30.612277, -96.341493),
	      new google.maps.LatLng(30.613317, -96.340693),
	      new google.maps.LatLng(30.613317, -96.340693),
	      new google.maps.LatLng(30.623406, -96.343441),
	      new google.maps.LatLng(30.623405, -96.343439),
	      new google.maps.LatLng(30.623412, -96.343438),
	      new google.maps.LatLng(30.623406, -96.343441),
	      new google.maps.LatLng(30.623405, -96.343439),
	      new google.maps.LatLng(30.623412, -96.343438),
	      new google.maps.LatLng(30.623412, -96.343438),
	      new google.maps.LatLng(30.625200, -96.303024),
	      new google.maps.LatLng(30.625200, -96.303024),
	      new google.maps.LatLng(30.618162, -96.304022),
	      new google.maps.LatLng(30.618161, -96.304024),
	      new google.maps.LatLng(30.618169, -96.304025),
	      new google.maps.LatLng(30.618165, -96.304020),
	      new google.maps.LatLng(30.616684, -96.348882),
	      new google.maps.LatLng(30.616685, -96.348887),
	      new google.maps.LatLng(30.616689, -96.348885)
        ];
        */
	    
//	    var cstat = new google.maps.LatLng(30.6014, -96.3144);
//	    var acadBldg = new google.maps.LatLng(30.615775, -96.340775);
	    var austin = new google.maps.LatLng( 30.246, -97.753);
        
        /*
        var mapOptions = {
          zoom: 13,	//bigger numbers mean closer zoom
          center: acadBldg
        };
        */
        
        var minimalStyle = [
          {
            featureType: "road",
            stylers: [
              { visibility: "off" }
            ]
          },
          {
            featureType: "transit",
            stylers: [
              { visibility: "off" }
            ]
          },
          {
            featureType: "poi",
            stylers: [
              { visibility: "off" }
            ]
          },
          {
            featureType: "landscape",
            stylers: [
              { visibility: "off" }
            ]
          }
        ];
        
        
        var mapOptions = {
          zoom: 4,	//bigger numbers mean closer zoom
          center: austin,
          styles: minimalStyle	//from here: http://stackoverflow.com/questions/8406636/how-to-remove-all-from-google-map
        };
                
        //map.setOptions({styles: styleArray});



        map = new google.maps.Map(document.getElementById('map-canvas'),
          mapOptions);

        /*
        var testGrad = [
          'rgba(0,0,0,0)',
          'rgba(255, 0, 0, 1)',
          'rgba(128, 0, 128, 1)',
          'rgba(0, 0, 255, 1)'
        ];
        
        //more crazy
        'rgba(255, 0, 0, 0)',
        'rgba(255, 255, 0, 0.9)',
        'rgba(0, 255, 0, 0.7)',
        'rgba(173, 255, 47, 0.5)',
        'rgba(152, 251, 152, 0)',
        'rgba(152, 251, 152, 0)',
        'rgba(0, 0, 238, 0.5)',
        'rgba(186, 85, 211, 0.7)',
        'rgba(255, 0, 255, 0.9)',
        'rgba(255, 0, 0, 1)'
        */
        
        var bluGrad = [
          'rgba(0, 0, 255, 0)',
          'rgba(0, 0, 255, 1)',
//          'rgba(0, 255, 255, 1)',
//          'rgba(255, 255, 255, 1)'
        ];
        var redGrad = [
          'rgba(255, 0, 0, 0)',
          'rgba(255, 0, 0, 1)'
        ];
        var cyanGrad = [
          'rgba(0, 255, 255, 0)',
          'rgba(0, 255, 255, 1)'
        ];
        var oranGrad = [
          'rgba(255, 128, 0, 0)',
          'rgba(255, 128, 0, 1)'
        ];
        var grnGrad = [
          'rgba(0, 255, 0, 0)',
          'rgba(0, 255, 0, 1)',
//          'rgba(255, 255, 0, 1)',
//          'rgba(255, 255, 255, 1)'
        ];

        rockmap = new google.maps.visualization.HeatmapLayer({
          //data: heatmapData,
          //data: rockMapData,
          data: testRockMapData,
          gradient: redGrad,	//from here: http://stackoverflow.com/questions/23878594/google-maps-api-heatmap-layer-single-gradient-two-extremes
          //radius: 25	
            //radius is in number of pixels
          radius : 8
        });

        rockmap.setMap(map);
        
        jazzmap = new google.maps.visualization.HeatmapLayer({
          data: testJazzMapData,
          gradient: oranGrad,
          radius : 8
        });
        
        //heatmap2.setMap(map);
        jazzmap.setMap(null);
        
        elecmap = new google.maps.visualization.HeatmapLayer({
          data: testElecMapData,
          gradient: cyanGrad,
          radius : 8
        });
        elecmap.setMap(null);
        
        countrymap = new google.maps.visualization.HeatmapLayer({
          data: testCountryMapData,
          gradient: grnGrad,
          radius : 8
        });
        countrymap.setMap(null);
        
        classmap = new google.maps.visualization.HeatmapLayer({
          data: testClassMapData,
          gradient: bluGrad,
          radius : 8
        });
        classmap.setMap(null);
        
      }
      
      function toggleRock() {
//        heatmap.setMap(boxstate ? map : null);	//only show if checked
        /*
        var on = false;
        
        
        $('#btn-group-vertical .btn.active').each(function() {	//from here: http://stackoverflow.com/questions/14035640/twitter-bootstrap-get-state-of-bootstrap-checkbox-buttons
          if (this.name == "rock") {
            on = this.value;
          }
        });
        
        if(on) {
          heatmap.setMap(map);
        }
        else {
          heatmap.setMap(null);
        }
        */
        
        //$('#rock')
        //$('input').prop('checked', false);	//this is to UNCHECK the button!

        rockmap.setMap(rockmap.getMap() ? null : map);
      }
      
      function toggleJazz() {
//        heatmap.setMap(boxstate ? map : null);	//only show if checked
        
        /*
        var on = false;
        
        
        $('#btn-group-vertical .btn.active').each(function() {	//from here: http://stackoverflow.com/questions/14035640/twitter-bootstrap-get-state-of-bootstrap-checkbox-buttons
          if (this.name == "jazz") {
            on = this.value;
          }
        });
        
        if(on) {
          heatmap2.setMap(map);
        }
        else {
          heatmap2.setMap(null);
        }
        */
        
        jazzmap.setMap(jazzmap.getMap() ? null : map);
      }
      
      function toggleClassical() {
        
        classmap.setMap(classmap.getMap() ? null : map);
      }
      function toggleCountry() {
        
        countrymap.setMap(countrymap.getMap() ? null : map);
      }
      function toggleElectronic() {
        
        elecmap.setMap(elecmap.getMap() ? null : map);
      }
      
      
      
      
      google.maps.event.addDomListener(window, 'load', initialize);
      
	</script>
	 
  </head>
  <body>
    
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="dist/js/bootstrap.min.js"></script>
	 
	 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">GigFinder</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about" data-toggle="modal" data-target="#aboutModal">About</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
	 
	<div class="jumbotron">
	  <div class="container">
		<h1>GigFinder</h1>
		<p>Find where you should play your next gig</p>
	  </div>
	</div>

	<!-- MAP DIVS -->
	<div id="map-module">
	
      <div class="heatmap" id="map-canvas"></div>
	
      <div class="btn-group-vertical" id="side_panel" role="group" data-toggle="buttons" aria-label="..."> <!-- from http://getbootstrap.com/javascript/#buttons-checkbox-radio -->  
        <label class="btn btn-primary" name="classical" onclick="toggleClassical()">	<!-- will want to change color probs -->
          <input type="checkbox" autocomplete="off"> Classical
        </label>
        <label class="btn btn-success" name="country" onclick="toggleCountry()">
          <input type="checkbox" autocomplete="off"> Country
        </label>
        <label class="btn btn-info" name="electronic" onclick="toggleElectronic()">
          <input type="checkbox" autocomplete="off"> Electronic
        </label>
        <label class="btn btn-warning" name="jazz" onclick="toggleJazz()">
          <input id="jazz" type="checkbox" autocomplete="off"> Jazz
        </label>
        <label class="btn btn-danger active" name="rock" onclick="toggleRock()"> <!--  id="rock"-->
          <input id="rock" type="checkbox" autocomplete="off" checked> Rock
        </label>
      </div>
	
    </div>
	
	
	
	
	
	<div class="container-fluid">
		<button id="find_gig" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#findGigModal">Find a Gig</button>
    </div>
	
	<!-- Modal -->
	<div class="modal fade" id="findGigModal" tabindex="-1" role="dialog" aria-labelledby="findGigModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
		 <div class="modal-content">
			<div class="modal-header">
			  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
			  <h4 class="modal-title" id="myModalLabel">Find Gig</h4>
			</div>
			<div class="modal-body">
			  <p>
					Enter information about your band
			  </p>
			  <form role="form">
				  <div class="form-group">
					 <label for="inputGenre1">Genre</label>
					 <input type="text" class="form-control" id="inputGenre1" placeholder="Enter genre">
				  </div>
				  <div class="form-group">
					 <label for="inputCountry1">Country</label>
					 <input type="text" class="form-control" id="inputCountry1" placeholder="Country">
				  </div>
				</form>
			</div>
			<div class="modal-footer">
			  <button type="button" class="btn btn-primary" onclick=findGig() data-dismiss="modal">Find Gig</button>
			</div>
		 </div>
	  </div>
	</div>
	
	<div class="modal fade" id="aboutModal" tabindex="-1" role="dialog" aria-labelledby="aboutModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
		 <div class="modal-content">
			<div class="modal-header">
			  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
			  <h4 class="modal-title" id="myModalLabel">About</h4>
			</div>
			<div class="modal-body">
			  <p>
					This project was created by Garrett Goble, Oliver Hatfield, and Ryan Olivieri for Dr. Caverlee's CSCE 470 class.
			  </p>
			</div>
			<div class="modal-footer">
			  <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
			</div>
		 </div>
	  </div>
	</div>
  </body>
</html>